!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.MIPSAssem=r():t.MIPSAssem=r()}(window,function(){return function(t){var r={};function e(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=r,e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:a})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)e.d(a,n,function(r){return t[r]}.bind(null,n));return a},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=0)}([function(t,r,e){"use strict";e.r(r);const a={r0:0,zero:0,at:1,v0:2,v1:3,a0:4,a1:5,a2:6,a3:7,t0:8,t1:9,t2:10,t3:11,t4:12,t5:13,t6:14,t7:15,s0:16,s1:17,s2:18,s3:19,s4:20,s5:21,s6:22,s7:23,t8:24,t9:25,k0:26,k1:27,gp:28,sp:29,fp:30,ra:31};function n(t){if(t)return a[t.toLowerCase()]}const i={S:16,D:17,W:20,L:21};function o(t){return i[t.toUpperCase()]}const s={S:0,D:1,W:4,L:5};function l(t){return s[t.toUpperCase()]}function f(t){return i.hasOwnProperty(t.toUpperCase())||s.hasOwnProperty(t.toUpperCase())}const u={F:0,UN:1,EQ:2,UEQ:3,OLT:4,ULT:5,OLE:6,ULE:7,SF:8,NGLE:9,SEQ:10,NGL:11,LT:12,NGE:13,LE:14,NGT:15};function d(t){return u[t.toUpperCase()]}function m(t){return u.hasOwnProperty(t.toUpperCase())}function c(t){return"0"===t[0]||"1"===t[0]}function p(t){let r=0;for(var e=0;e<t.length;e++){r<<=1,r|="1"===t[e]?1:0}return r}function y(t){if(t<=0)throw new Error(`makeBitMask cannot make mask of length ${t}`);let r=1;for(;--t;)r<<=1,r|=1;return r}function w(t,r,e,a){let n,[i,o,s]=t;return n="b"===(o=o.toLowerCase())?parseInt(s,2):"o"===o?parseInt(s,8):"x"===o?parseInt(s,16):parseInt(s,10),a&&(n>>>=a),16===r&&e&&(n=b(n)),i&&(n=-n),n}function b(t){return new Int16Array([t])[0]}function h(t){if("?"===t[t.length-1]&&(t=t.substring(0,t.length-1)),-1===t.indexOf("int"))return"cc"===t.substr(0,2)?{signed:!1,bits:4,shift:!1}:null;let r=0;const e=t.indexOf("shift");return e>0&&(r=t.substr(e).match(/\d+/g)),{signed:"u"!==t[0],bits:parseInt(t.match(/\d+/g)),shift:r}}const v="rs",g="rt",x="rd",I="fs",E="ft",S="fd",P="fr",z="uint5",$="uint5",D="int16",C="uint16",L="cc",O="fmt",U="fmt3";function j(t){return A[t.toLowerCase()]}function V(t){if(c(t))return t.length;switch(t=t.replace("?","")){case"cc":case"fmt3":return 3;case"cond":return 4;case"rs":case"rt":case"rd":case"fs":case"ft":case"fd":case"fr":case"sa":case"fmt":return 5}const r=h(t);if(r)return r.bits;throw new Error(`Unrecongized format value: ${t}`)}const A={"abs.fmt":{format:["010001",O,"00000",I,S,"000101"],fmts:["S","D"],display:[S,I]},add:{format:["000000",v,g,x,"00000100000"],display:[x,v,g]},"add.fmt":{format:["010001",O,E,I,S,"000000"],fmts:["S","D"],display:[S,I,E]},addi:{format:["001000",v,g,D],display:[g,v,D]},addiu:{format:["001001",v,g,C],display:[g,v,C]},addu:{format:["000000",v,g,x,"00000100001"],display:[x,v,g]},and:{format:["000000",v,g,x,"00000100100"],display:[x,v,g]},andi:{format:["001100",v,g,C],display:[g,v,C]},bc1f:{format:["010001","01000",[L,"000"],"00",D],display:["cc?",D]},bc1fl:{format:["010001","01000",[L,"000"],"10",D],display:["cc?",D]},bc1t:{format:["010001","01000",[L,"000"],"01",D],display:["cc?",D]},bc1tl:{format:["010001","01000",[L,"000"],"11",D],display:["cc?",D]},beq:{format:["000100",v,g,C],display:[v,g,C]},beql:{format:["010100",v,g,C],display:[v,g,C]},bgez:{format:["000001",v,"00001",C],display:[v,C]},bgezal:{format:["000001",v,"10001",C],display:[v,C]},bgezall:{format:["000001",v,"10011",C],display:[v,C]},bgezl:{format:["000001",v,"00011",C],display:[v,C]},bgtz:{format:["000111",v,"00000",C],display:[v,C]},bgtzl:{format:["010111",v,"00000",C],display:[v,C]},blez:{format:["000110",v,"00000",C],display:[v,C]},blezl:{format:["010110",v,"00000",C],display:[v,C]},bltz:{format:["000001",v,"00000",C],display:[v,C]},bltzal:{format:["000001",v,"10000",C],display:[v,C]},bltzall:{format:["000001",v,"10010",C],display:[v,C]},bltzl:{format:["000001",v,"00010",C],display:[v,C]},bne:{format:["000101",v,g,C],display:[v,g,C]},bnel:{format:["010101",v,g,C],display:[v,g,C]},break:{format:["000000",["uint20","00000000000000000000"],"001101"],display:[]},"c.cond.fmt":{format:["010001",O,E,I,[L,"000"],"00","11","cond"],fmts:["S","D"],display:["cc?",I,E]},"ceil.l.fmt":{format:["010001",O,"00000",I,S,"001010"],fmts:["S","D"],display:[S,I]},"ceil.w.fmt":{format:["010001",O,"00000",I,S,"001110"],fmts:["S","D"],display:[S,I]},cfc1:{format:["010001","00010",g,I,"00000000000"],display:[g,I]},ctc1:{format:["010001","00110",g,I,"00000000000"],display:[g,I]},cop0:{format:["010000","uint26"],display:["uint26"]},cop1:{format:["010001","uint26"],display:["uint26"]},cop2:{format:["010010","uint26"],display:["uint26"]},cop3:{format:["010011","uint26"],display:["uint26"]},"cvt.d.fmt":{format:["010001",O,"00000",I,S,"100001"],fmts:["S","W","L"],display:[S,I]},"cvt.l.fmt":{format:["010001",O,"00000",I,S,"100101"],fmts:["S","D"],display:[S,I]},"cvt.s.fmt":{format:["010001",O,"00000",I,S,"100000"],fmts:["D","W","L"],display:[S,I]},"cvt.w.fmt":{format:["010001",O,"00000",I,S,"100100"],fmts:["S","D"],display:[S,I]},dadd:{format:["000000",v,g,x,"00000101100"],display:[x,v,g]},daddi:{format:["011000",v,g,D],display:[g,v,D]},daddiu:{format:["011001",v,g,C],display:[g,v,C]},daddu:{format:["000000",v,g,x,"00000101101"],display:[x,v,g]},ddiv:{format:["000000",v,g,"0000000000011110"],display:[v,g]},ddivu:{format:["000000",v,g,"0000000000011111"],display:[v,g]},div:{format:["000000",v,g,"0000000000011010"],display:[v,g]},"div.fmt":{format:["010001",O,E,I,S,"000011"],fmts:["S","D"],display:[S,I,E]},divu:{format:["000000",v,g,"0000000000011011"],display:[v,g]},dmfc1:{format:["010001","00001",g,I,"00000000000"],display:[g,I]},dmult:{format:["000000",v,g,"0000000000011100"],display:[v,g]},dmultu:{format:["000000",v,g,"0000000000011101"],display:[v,g]},dmtc1:{format:["010001","00101",g,I,"00000000000"],display:[g,I]},dsll:{format:["00000000000",g,x,z,"111000"],display:[x,g,z]},dsll32:{format:["00000000000",g,x,z,"111100"],display:[x,g,z]},dsllv:{format:["000000",v,g,x,"00000010100"],display:[x,g,v]},dsra:{format:["00000000000",g,x,z,"111011"],display:[x,g,z]},dsra32:{format:["00000000000",g,x,z,"111111"],display:[x,g,z]},dsrav:{format:["000000",v,g,x,"00000010111"],display:[x,g,v]},dsrl:{format:["00000000000",g,x,z,"111010"],display:[x,g,z]},dsrl32:{format:["00000000000",g,x,z,"111110"],display:[x,g,z]},dsrlv:{format:["000000",v,g,x,"00000010110"],display:[x,g,v]},dsub:{format:["000000",v,g,x,"00000101110"],display:[x,v,g]},dsubu:{format:["000000",v,g,x,"00000101111"],display:[x,v,g]},"floor.l.fmt":{format:["010001",O,"00000",I,S,"001011"],fmts:["S","D"],display:[S,I]},"floor.w.fmt":{format:["010001",O,"00000",I,S,"001111"],fmts:["S","D"],display:[S,I]},j:{format:["000010","uint26shift2"],display:["uint26shift2"]},jal:{format:["000011","uint26shift2"],display:["uint26shift2"]},jalr:{format:["000000",v,"00000",[x,"11111"],"00000","001001"],display:["rd?",v]},jr:{format:["000000",v,"000000000000000","001000"],display:[v]},lb:{format:["100000",v,g,D],display:[g,D,"(",v,")"]},lbu:{format:["100100",v,g,C],display:[g,C,"(",v,")"]},ld:{format:["110111",v,g,D],display:[g,D,"(",v,")"]},ldc1:{format:["110101",v,E,D],display:[E,D,"(",v,")"]},ldc2:{format:["110110",v,g,D],display:[g,D,"(",v,")"]},ldl:{format:["011010",v,g,D],display:[g,D,"(",v,")"]},ldr:{format:["011011",v,g,D],display:[g,D,"(",v,")"]},ldxc1:{format:["010011",v,g,"00000",S,"000001"],display:[S,g,"(",v,")"]},lh:{format:["100001",v,g,D],display:[g,D,"(",v,")"]},lhu:{format:["100101",v,g,D],display:[g,D,"(",v,")"]},ll:{format:["110000",v,g,D],display:[g,D,"(",v,")"]},lld:{format:["110100",v,g,D],display:[g,D,"(",v,")"]},lui:{format:["001111","00000",g,C],display:[g,C]},lw:{format:["100011",v,g,D],display:[g,D,"(",v,")"]},lwc1:{format:["110001",v,E,D],display:[E,D,"(",v,")"]},lwc2:{format:["110010",v,g,D],display:[g,D,"(",v,")"]},lwc3:{format:["110011",v,g,D],display:[g,D,"(",v,")"]},lwl:{format:["100010",v,g,D],display:[g,D,"(",v,")"]},lwr:{format:["100110",v,g,D],display:[g,D,"(",v,")"]},lwu:{format:["100111",v,g,D],display:[g,D,"(",v,")"]},lwxc1:{format:["010011",v,g,"00000",S,"000000"],display:[S,g,"(",v,")"]},"madd.fmt":{format:["010011",P,E,I,S,"100",U],fmts:["S","D"],display:[S,P,I,E]},mfc1:{format:["010001","00000",g,I,"00000000000"],display:[g,I]},mfhi:{format:["000000","0000000000",x,"00000","010000"],display:[x]},mflo:{format:["000000","0000000000",x,"00000","010010"],display:[x]},"mov.fmt":{format:["010001",O,"00000",I,S,"000110"],fmts:["S","D"],display:[S,I]},movf:{format:["000000",v,L,"00",x,"00000","000001"],display:[x,v,L]},"movf.fmt":{format:["010001",O,L,"00",I,S,"010001"],fmts:["S","D"],display:[S,I,L]},movn:{format:["000000",v,g,x,"00000","001011"],display:[x,v,g]},"movn.fmt":{format:["010001",O,g,I,S,"010011"],fmts:["S","D"],display:[S,I,g]},movt:{format:["000000",v,L,"01",x,"00000","000001"],display:[x,v,L]},"movt.fmt":{format:["010001",O,L,"01",I,S,"010001"],fmts:["S","D"],display:[S,I,L]},movz:{format:["000000",v,g,x,"00000","001010"],display:[x,v,g]},"movz.fmt":{format:["010001",O,g,I,S,"010010"],fmts:["S","D"],display:[S,I,g]},"msub.fmt":{format:["010011",P,E,I,S,"101",U],fmts:["S","D"],display:[S,P,I,E]},mtc1:{format:["010001","00100",g,I,"00000000000"],display:[g,I]},mthi:{format:["000000",v,"000000000000000","010001"],display:[v]},mtlo:{format:["000000",v,"000000000000000","010011"],display:[v]},"mul.fmt":{format:["010001",O,E,I,S,"000010"],fmts:["S","D"],display:[S,I,E]},mult:{format:["000000",v,g,"0000000000","011000"],display:[v,g]},multu:{format:["000000",v,g,"0000000000","011001"],display:[v,g]},"neg.fmt":{format:["010001",O,"00000",I,S,"000111"],fmts:["S","D"],display:[S,I]},"nmadd.fmt":{format:["010011",P,E,I,S,"110",U],fmts:["S","D"],display:[S,P,I,E]},"nmsub.fmt":{format:["010011",P,E,I,S,"111",U],fmts:["S","D"],display:[S,P,I,E]},nop:{format:["00000000000000000000000000000000"],display:[]},nor:{format:["000000",v,g,x,"00000","100111"],display:[x,v,g]},or:{format:["000000",v,g,x,"00000","100101"],display:[x,v,g]},ori:{format:["001101",v,g,C],display:[g,v,C]},pref:{format:["110011",v,$,D],display:[$,D,"(",v,")"]},prefx:{format:["010011",v,g,$,"00000","001111"],display:[$,g,"(",v,")"]},"recip.fmt":{format:["010001",O,"00000",I,S,"010101"],fmts:["S","D"],display:[S,I]},"round.l.fmt":{format:["010001",O,"00000",I,S,"001000"],fmts:["S","D"],display:[S,I]},"round.w.fmt":{format:["010001",O,"00000",I,S,"001100"],fmts:["S","D"],display:[S,I]},"rsqrt.fmt":{format:["010001",O,"00000",I,S,"010110"],fmts:["S","D"],display:[S,I]},sb:{format:["101000",v,g,D],display:[g,D,"(",v,")"]},sc:{format:["111000",v,g,D],display:[g,D,"(",v,")"]},scd:{format:["111100",v,g,D],display:[g,D,"(",v,")"]},sd:{format:["111111",v,g,D],display:[g,D,"(",v,")"]},sdc1:{format:["111101",v,E,D],display:[E,D,"(",v,")"]},sdc2:{format:["111110",v,g,D],display:[g,D,"(",v,")"]},sdl:{format:["101100",v,g,D],display:[g,D,"(",v,")"]},sdr:{format:["101101",v,g,D],display:[g,D,"(",v,")"]},sdxc1:{format:["010011",v,$,I,"00000","001001"],display:[I,$,"(",v,")"]},sh:{format:["101001",v,g,D],display:[g,D,"(",v,")"]},sll:{format:["000000","00000",g,x,z,"000000"],display:[x,g,z]},sllv:{format:["000000",v,g,x,"00000","000100"],display:[x,g,v]},slt:{format:["000000",v,g,x,"00000","101010"],display:[x,v,g]},slti:{format:["001010",v,g,D],display:[g,v,D]},sltiu:{format:["001011",v,g,C],display:[g,v,C]},sltu:{format:["000000",v,g,x,"00000","101011"],display:[x,v,g]},"sqrt.fmt":{format:["010001",O,"00000",I,S,"000100"],fmts:["S","D"],display:[S,I]},sra:{format:["000000","00000",g,x,z,"000011"],display:[x,g,z]},srav:{format:["000000",v,g,x,"00000","000111"],display:[x,g,v]},srl:{format:["000000","00000",g,x,z,"000010"],display:[x,g,z]},srlv:{format:["000000",v,g,x,"00000","000110"],display:[x,g,v]},sub:{format:["000000",v,g,x,"00000","100010"],display:[x,v,g]},"sub.fmt":{format:["010001",O,E,I,S,"000001"],fmts:["S","D"],display:[S,I,E]},subu:{format:["000000",v,g,x,"00000","100011"],display:[x,v,g]},sw:{format:["101011",v,g,D],display:[g,D,"(",v,")"]},swc1:{format:["111001",v,E,D],display:[E,D,"(",v,")"]},swc2:{format:["111010",v,g,D],display:[g,D,"(",v,")"]},swc3:{format:["111011",v,g,D],display:[g,D,"(",v,")"]},swl:{format:["101010",v,g,D],display:[g,D,"(",v,")"]},swr:{format:["101110",v,g,D],display:[g,D,"(",v,")"]},swxc1:{format:["010011",v,$,I,"00000","001000"],display:[I,$,"(",v,")"]},sync:{format:["000000","000000000000000","00000","001111"],display:[]},syscall:{format:["000000",["uint20","00000000000000000000"],"001100"],display:[]},teq:{format:["000000",v,g,"uint10","110100"],display:[v,g]},teqi:{format:["000001",v,"01100",D],display:[v,D]},tge:{format:["000000",v,g,"uint10","110000"],display:[v,g]},tgei:{format:["000001",v,"01000",D],display:[v,D]},tgeiu:{format:["000001",v,"01001",C],display:[v,C]},tgeu:{format:["000000",v,g,"uint10","110001"],display:[v,g]},tlt:{format:["000000",v,g,"uint10","110010"],display:[v,g]},tlti:{format:["000001",v,"01010",D],display:[v,D]},tltiu:{format:["000001",v,"01011",C],display:[v,C]},tltu:{format:["000000",v,g,"uint10","110011"],display:[v,g]},tne:{format:["000000",v,g,"uint10","110110"],display:[v,g]},tnei:{format:["000001",v,"01110",D],display:[v,D]},"trunc.l.fmt":{format:["010001",O,"00000",I,S,"001001"],fmts:["S","D"],display:[S,I]},"trunc.w.fmt":{format:["010001",O,"00000",I,S,"001101"],fmts:["S","D"],display:[S,I]},xor:{format:["000000",v,g,x,"00000","100110"],display:[x,v,g]},xori:{format:["001110",v,g,C],display:[g,v,C]}},k="([A-Za-z0-3.]+)",N="(-)?0?([xbo]?)([A-Fa-f0-9]+)",q="\\$?(\\w+)",M="\\$?[Ff]([0-9]+)",B=new RegExp("^\\s*"+k);function F(t){const r=B.exec(t);if(r){const t=r[1].split(".");if(1===t.length)return t[0].toLowerCase();let e="",a=!1,n=!1;for(let r=t.length-1;r>0;r--){let i=t[r];a||("fmt"===i||f(i))&&(a=!0,i="fmt"),n||m(i)&&(n=!0,i="cond"),e="."+i+e}return(t[0]+e).toLowerCase()}return null}function W(t){if(function(t){if(!t)return!1;switch(t.substr(0,2)){case"rs":case"rt":case"rd":return!0}return!1}(t))return q;if(function(t){if(!t)return!1;switch(t.substr(0,2)){case"fs":case"ft":case"fd":return!0}return!1}(t))return M;if(h(t))return N;throw new Error(`Unrecognized display entry ${t}`)}function T(t,r){return t+"\\s*\\(?"+r+"\\)?"}function _(t,r){if(r=function(t){return Object.assign({intermediate:!1},t)}(r),Array.isArray(t))return t.map(t=>G(t,r));if("object"==typeof t)return G(t,r);if("string"==typeof t){const e=t.split(/\r?\n/).filter(t=>!!t.trim());return 1===e.length?G(e[0],r):e.map(t=>G(t,r))}throw new Error("Unexpected input to parse. Pass a string or array of strings.")}function G(t,r){let e,a,i;if("string"==typeof t){if(!(e=F(t)))throw new Error(`Could not parse opcode from ${t}`);i=function(t,r,e){let a=function(t){const r=t.display,e=[k];for(let t=0;t<r.length;t++){const a=r[t],n=a.endsWith("?");let i="";if(n&&(i+="(?:"),"("===r[t+1]){if(n)throw new Error("Not prepared to generate optional regex with parenthesis");if(")"!==r[t+3])throw new Error("Not prepared to generate regex for multiple values in parenthesis");i+=T(W(a),W(r[t+2])),t+=3}else i+=W(a);n&&(i+="[,\\s]+)?"),e.push(i)}let a="^\\s*"+e.reduce((t,r,a)=>a===e.length-1?t+r:r.startsWith("(?:")?t+r:t+r+"[,\\s]+","")+"\\s*$";return new RegExp(a)}(r).exec(e);if(!a)throw`Could not parse instruction: ${e}`;let i={op:t};-1===t.indexOf(".fmt")&&-1===t.indexOf(".cond")||function(t,r,e,a,n){const i=t.split("."),s=r.split(".");if(i.length!==s.length)throw`Given opcode ${t} does not have all pieces (${r})`;for(let t=0;t<s.length;t++){const r=s[t];if("fmt"===r||"ftm3"===r){if(-1===e.indexOf(i[t]))throw`Format ${i[t]} is not allowed for ${r}. Allowed values are ${e}`;"fmt"===r?n.fmt=o(i[t]):"fmt3"===r&&(n.fmt3=l(i[t]))}"cond"===r&&(n.cond=d(i[t]))}}(a[1],t,r.fmts,r.format,i);const s=r.display;let f=2;for(let t=0;t<s.length;t++,f++){const r=a[f];let e=s[t];const o=e.endsWith("?");switch(e=e.replace("?","")){case"(":case")":f--;continue;case"rs":case"rd":case"rt":{const t=n(r);if(void 0===t){if(o)continue;throw new Error(`Unrecognized ${e} register ${r}`)}i[e]=t;continue}case"fs":case"ft":case"fd":case"fr":if(i[e]=parseInt(r),isNaN(i[e]))throw new Error(`Unrecognized ${e} register ${r}`);continue}const l=h(e);if(!l)throw`Unrecognized opcode display entry ${e}`;{let t;const r=[a[f],a[f+1],a[f+2]];o&&!r[2]||(t=w(r,l.bits,l.signed,l.shift),i[e]=t),f+=2}}return i}(e,a=j(e),t)}else if("object"==typeof t){if(!(e=F(t.op)))throw new Error("Object input to parse did not contain 'op'");a=j(e),i=t}if(!a)throw new Error(`Opcode ${e} was not recognized`);return r.intermediate?i:function(t,r){let e=0,a=0;for(let n=0;n<t.length;n++){let i,o=t[n],s=V(Array.isArray(o)?o[0]:o);if(e=e<<s>>>0,Array.isArray(o)){for(let t=0;t<o.length;t++)if((i=Q(o[t],e,r)).wrote){e=i.output;break}}else(i=Q(o,e,r)).wrote&&(e=i.output);a+=s}if(32!=a)throw new Error("Incorrect number of bits written for format "+t);return e}(a.format,i)}function Q(t,r,e){let a=!1;if(c(t))r|=p(t),a=!0;else if(void 0!==e[t]){a=!0,r|=e[t]&y(V(t))}return{wrote:a,output:r>>>0}}var R;function Z(t){if("string"!=typeof t)return null;var r,e="-"===t[0];return e&&(t=t.substr(1)),r="b"===t[0]||"0"===t[0]&&"b"===t[1]?parseInt(t.substr(2),2):"o"===t[0]||"0"===t[0]&&"o"===t[1]?parseInt(t.substr(2),8):"x"===t[0]||"0"===t[0]&&"x"===t[1]?parseInt(t.substr(2),16):parseInt(t,10),isNaN(r)?null:(e&&(r=-r),r)}function H(t){var r=t.line.match(/^((?:@@)?[\w\?\!]+)\:/);if(null===r)return!1;var e=r[1];if(J(e)){if(!t.currentLabel)throw new Error("Local label "+e+" (starts with @@) cannot be used before a global label");!function(t,r,e){var a=t.localSymbols[t.currentLabel];a||(a=t.localSymbols[t.currentLabel]=Object.create(null));a[r]=e}(t,e,K(t))}else t.currentLabel=e,X(t,e,K(t));return e}function J(t){return 0===t.indexOf("@@")}function K(t){return t.memPos+t.outIndex>>>0}function X(t,r,e){t.symbols[r]=e,t.symbolsByValue[e]=r}function Y(t,r){if(J(r)){if(!t.currentLabel)throw new Error("Local label "+r+" cannot be referenced in the current scope");var e=t.localSymbols[t.currentLabel];return e&&e[r]||null}return t.symbols[r]||null}!function(t){t[t.firstPass=0]="firstPass",t[t.secondPass=1]="secondPass"}(R||(R={}));var tt=/^\.definelabel\s+(\w+)[\s,]+(\w+)$/i;function rt(t){var r=t.line.match(tt);if(null===r)return!1;var e=r[1],a=r[2],n=Z(a);if(null===n){var i=Y(t,a);if(null===i)throw new Error(".definelabel value must be numeric or an alias to another label");X(t,e,i)}else X(t,e,n);return!0}var et=/^\.org\s+(\w+)$/i;function at(t){var r=t.line.match(et);if(null===r)return!1;var e=r[1],a=Z(e);if(null===a)throw new Error("Could not parse .org immediate "+e);return t.memPos=a>>>0,!0}var nt=/^\.orga\s+(\w+)$/i;function it(t){var r=t.line.match(nt);if(null===r)return!1;var e=r[1],a=Z(e);if(null===a)throw new Error("Could not parse .orga immediate "+e);return t.outIndex=a>>>0,!0}var ot=/^\.align\s+([-\w]+)$/i;function st(t){var r=t.line.match(ot);if(null===r)return!1;var e=r[1],a=Z(e);if(null===a)throw new Error("Could not parse .align immediate "+e);if(a%2)throw new Error(".align directive requires a power of two.");if(a<0)throw new Error(".align directive cannot align by a negative value.");for(;t.outIndex%a;)t.currentPass===R.secondPass&&t.dataView.setUint8(t.outIndex,0),t.outIndex++;return!0}var lt=/^\.skip\s+([-\w]+)$/i;function ft(t){var r=t.line.match(lt);if(null===r)return!1;var e=r[1],a=Z(e);if(null===a)throw new Error("Could not parse .skip immediate "+e);if(a<0)throw new Error(".skip directive cannot skip a negative length.");return t.outIndex+=a,!0}var ut=/^\.fill\s+([-\w]+)$/i,dt=/^\.fill\s+([-\w]+),\s*([-\w]+)$/i;function mt(t){var r,e,a,n,i=t.line.match(ut);if(i)r=i[1];else{if(!(i=t.line.match(dt)))return!1;r=i[1],a=i[2]}if(null===(e=Z(r)))throw new Error("Could not parse .fill length "+r);if(e<0)throw new Error(".fill length must be positive.");if(a){if(null===(n=Z(a)))throw new Error("Could not parse .fill value "+a)}else n=0;if(t.currentPass===R.secondPass)for(var o=0;o<e;o++)t.dataView.setInt8(t.outIndex+o,n);return t.outIndex+=e,!0}var ct=/^\.ascii\s+([\\'\",-\w\s]+)$/i,pt=/^\.asciiz\s+([\\'\",-\w\s]+)$/i;function yt(t){var r=!1,e=t.line.match(ct);if(!e){if(!(e=t.line.match(pt)))return!1;r=!0}for(var a=e[1],n=[],i="",o="",s=!1,l=0;l<a.length;l++){var f=a[l];if(!s&&!o){if("\\"===f){s=!0;continue}if('"'===f||"'"===f){if(o)throw new Error("Encountered string during parsing of number: "+o);if(i&&i===f){i="";continue}if(!i){i=f;continue}}}if(s=!1,i)n.push(a.charCodeAt(l));else if(/[,\s]+/.test(f)){if(o){if(null===(u=Z(o)))throw new Error("Could not parse immediate "+o);n.push(u)}o=""}else o+=f}if(i)throw new Error("Unterminated string: "+a);if(o){var u;if(null===(u=Z(o)))throw new Error("Could not parse immediate "+o);n.push(u)}if(r&&n.push(0),t.currentPass===R.secondPass)for(l=0;l<n.length;l++)n[l]<0?t.dataView.setInt8(t.outIndex+l,n[l]):t.dataView.setUint8(t.outIndex+l,n[l]);return t.outIndex+=n.length,!0}var wt=/^\.byte\s+([,-\w\s]+)$/i,bt=/^\.db\s+([,-\w\s]+)$/i;function ht(t){var r=t.line.match(wt);if(!r&&!(r=t.line.match(bt)))return!1;var e=r[1].split(",").map(function(t){return t.trim()}).filter(function(t){return!!t}).map(function(t){var r=Z(t);if(null===r)throw new Error("Could not parse .byte immediate "+t);return r});if(t.currentPass===R.secondPass)for(var a=0;a<e.length;a++)e[a]<0?t.dataView.setInt8(t.outIndex+a,e[a]):t.dataView.setUint8(t.outIndex+a,e[a]);return t.outIndex+=e.length,!0}var vt=/^\.halfword\s+([,-\w\s]+)$/i,gt=/^\.dh\s+([,-\w\s]+)$/i;function xt(t){var r=t.line.match(vt);if(!r&&!(r=t.line.match(gt)))return!1;var e=r[1].split(",").map(function(t){return t.trim()}).filter(function(t){return!!t}).map(function(t){var r=Z(t);if(null===r)throw new Error("Could not parse .halfword immediate "+t);return r});if(t.currentPass===R.secondPass)for(var a=0;a<e.length;a++)e[a]<0?t.dataView.setInt16(t.outIndex+2*a,e[a]):t.dataView.setUint16(t.outIndex+2*a,e[a]);return t.outIndex+=2*e.length,!0}var It=/^\.word\s+([,-\w\s]+)$/i,Et=/^\.dw\s+([,-\w\s]+)$/i;function St(t){var r=t.line.match(It);if(!r&&!(r=t.line.match(Et)))return!1;var e=r[1].split(",").map(function(t){return t.trim()}).filter(function(t){return!!t}).map(function(t){var r=Z(t);if(null===r)throw new Error("Could not parse .word immediate "+t);return r});if(t.currentPass===R.secondPass)for(var a=0;a<e.length;a++)e[a]<0?t.dataView.setInt32(t.outIndex+4*a,e[a]):t.dataView.setUint32(t.outIndex+4*a,e[a]);return t.outIndex+=4*e.length,!0}var Pt=/^\.float\s+([,-\.\w\s]+)$/i;function zt(t){var r=t.line.match(Pt);if(!r)return!1;var e=r[1].split(",").map(function(t){return t.trim()}).filter(function(t){return!!t}).map(function(t){var r=parseFloat(t);if(null===r)throw new Error("Could not parse .float immediate "+t);return r});if(t.currentPass===R.secondPass)for(var a=0;a<e.length;a++)t.dataView.setFloat32(t.outIndex+4*a,e[a]);return t.outIndex+=4*e.length,!0}function $t(t){if(![rt,at,it,st,ft,mt,yt,ht,xt,St,zt].some(function(r){return r(t)}))throw new Error("handleDirective: Unrecongized directive "+t.line)}function Dt(t,r){var e=function t(r,e,a){var n=/^(\w+)\(([\(\),\w+]+)\)$/.exec(r);if(null===n){var i=null;if(a&&null!==(i=Z(r)))return i;var o=Y(e,r);return null!==o?o:null}var s=n[1],l=n[2];if(!Ct[s]){var o=Y(e,s);return null!==o?o:null}return Ct[s].call(Ct[s],t(l,e,!0))}(t,r,!1);return null!==e?"0x"+e.toString(16).toUpperCase():null}var Ct={hi:function(t){var r=t>>>16;return 32768&(65535&t)&&(r+=1),r},lo:function(t){return 65535&t}};function Lt(t,r){r=r||{};var e=function(t){if("string"==typeof t)return t.split(/\r?\n/);if(!Array.isArray(t))throw new Error("Input must be a string or array of strings");return t}(t);e=(e=(e=function(t){return t.map(function(t){var r=t.indexOf(";"),e=t.indexOf("//");if(-1===r&&-1===e)return t;var a=r;return-1===a?a=e:-1!==e&&(a=Math.min(r,e)),t.substr(0,a)})}(e=e.filter(function(t){return"string"==typeof t}))).map(function(t){return t.trim()})).filter(Boolean);var a={buffer:null,dataView:null,line:"",memPos:0,outIndex:0,symbols:Object.create(null),symbolsByValue:Object.create(null),currentLabel:null,localSymbols:Object.create(null),currentPass:R.firstPass},n=[];return e=(e=e.map(function(t){if(a.line=t,"."===t[0])return $t(a),t;for(var r;r=H(a);)a.line=t=t.substr(r.length+1).trim();return t&&(a.outIndex+=4),t})).filter(Boolean),a.buffer=r.buffer||new ArrayBuffer(a.outIndex),a.dataView=new DataView(a.buffer),a.memPos=0,a.outIndex=0,a.currentPass=R.secondPass,e.forEach(function(t){if(a.line=t,"."!==t[0]){var e=function(t,r){return t.symbolsByValue[r]||null}(a,a.memPos+a.outIndex);null!==e&&(a.currentLabel=e);var i=t.split(/[,\s]+/g);if(i.length){var o=Dt(i[i.length-1],a);null!==o&&(o=function(t,r,e){if(function(t){if("b"!==(t=t.toLowerCase())[0])return!1;switch(t){case"bc1f":case"bc1fl":case"bc1t":case"bc1tl":case"beq":case"beql":case"bgez":case"bgezal":case"bgezall":case"bgezl":case"bgtz":case"bgtzl":case"blez":case"blezl":case"bltz":case"bltzal":case"bltzall":case"bltzl":case"bne":case"bnel":return!0}return!1}(t)){var a=Z(r),n=e.memPos+e.outIndex,i=(a-n)/4-1;return i.toString()}return r}(i[0],o,a),i[i.length-1]=o,t=i.join(" "))}r.text&&n.push(t);var s=_(t);a.dataView.setUint32(a.outIndex,s),a.outIndex+=4}else $t(a)}),r.text?n:a.buffer}e.d(r,"assemble",function(){return Lt})}])});